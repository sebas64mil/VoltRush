<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Autollenado de Productos</title>
</head>
<body>
  <h1>Autollenado 2 de Productos a Firebase</h1>
  <button id="fillBtn">Llenar productos</button>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import {
      getFirestore,
      doc,
      setDoc
    } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

    // Configuración Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyANIYCtkrM7UcmFJK4AunyERlGKiHN8l1k",
      authDomain: "voltrush-c1ee8.firebaseapp.com",
      projectId: "voltrush-c1ee8",
      storageBucket: "voltrush-c1ee8.firebasestorage.app",
      messagingSenderId: "902027158636",
      appId: "1:902027158636:web:18bcf5560098dd6f6fa449"
    };

    // Inicializar Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Servicio Firestore personalizado
    class FirestoreService {
      constructor(collectionName) {
        this.collectionName = collectionName;
      }

      async PostDocument(id, data) {
        const docRef = doc(db, this.collectionName, id);
        await setDoc(docRef, data);
      }
    }

    // Función para autollenar productos
    async function autoFillProducts() {
      const firestore = new FirestoreService("products");
      const headquartersOptions = ["bogota", "medellin", "cali", "barranquilla"];

      for (let i = 3; i <= 100; i++) {
        const randomPrice = (Math.random() * 1000).toFixed(2);
        const randomHeadquarters = headquartersOptions[Math.floor(Math.random() * headquartersOptions.length)];
        const randomDescription = `Descripción aleatoria ${Math.random().toString(36).substring(7)}`;
        const randomAmount = Math.floor(Math.random() * 100);

        const productData = {
          idProducto: i,
          name: `producto${i}`,
          price: parseFloat(randomPrice),
          description: randomDescription,
          headquarters: randomHeadquarters,
          amount: randomAmount // 🔄 Ya no está dentro de un array
        };

        const docId = i.toString();
        await firestore.PostDocument(docId, productData);
        console.log(`Producto ${i} creado.`);
      }

      alert("¡Productos generados exitosamente!");
    }

    // Botón para ejecutar
    document.getElementById("fillBtn").addEventListener("click", () => {
      autoFillProducts();
    });
  </script>
</body>
</html>
